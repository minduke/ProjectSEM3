@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<script>
    $.widget.bridge('uibutton', $.ui.button)

    /**CHART bar and line*/
   $.ajax({
    url: '@Url.Action("chartJS","Home")',
    type: 'POST', // Phương thức HTTP
    dataType: 'json', // Kiểu dữ liệu trả về
    success: function (data) {
        // Xử lý dữ liệu trả về
        console.log(data);

        // Tạo mảng chứa các giá trị transaction_no
        var transactionNos = data.map(function (item) {
            return item.transaction_amout;
        });

        // Tạo mảng chứa các nhãn cho biểu đồ
        var labels = data.map(function (item, index) {
            return 'Bài viết' + (index + 1);
        });

        // Tính tổng của dữ liệu
        var sum = 0;
        for (var i = 0; i < transactionNos.length; i++) {
            sum += transactionNos[i];
        }

        //// Tạo context và khởi tạo biểu đồ
        //var ctx = document.getElementById("myChart");
        //new Chart(ctx, {
        //    type: 'bar', // Thay đổi giá trị của type thành 'bar'
        //    data: {
        //        labels: labels,
        //        datasets: [{
        //            label: 'Bài viết được Donate',
        //            data: transactionNos,
        //            backgroundColor: [
        //                'rgb(255, 99, 132)',
        //                'rgb(54, 162, 235)',
        //                'rgb(255, 205, 86)',
        //                'rgb(255 ,0,  255)',
        //                'rgb(148,0,211)',
        //                'rgb(247, 0, 255)',
        //                'rgb(230, 142, 233)',
        //                'rgb(92, 246, 132)',
        //                'rgb(170, 249, 33)',
        //                'rgb(6, 247, 188)',
        //                'rgb(4, 68, 252)',
        //                'rgb(250, 0, 171 )',
        //                'rgb(223, 105, 0 )',
        //                'rgb(1, 178, 255 )',
        //                'rgb(17, 229, 0 )',
        //                'rgb(181, 189, 87 )',
        //                'rgb(4, 138, 100 )'
        //            ],
        //            borderColor: ['rgb(255, 99, 132)',
        //                'rgb(54, 162, 235)',
        //                'rgb(255, 205, 86)',
        //                'rgb(255 ,0,  255)',
        //                'rgb(148,0,211)',
        //                'rgb(247, 0, 255)',
        //                'rgb(230, 142, 233)',
        //                'rgb(92, 246, 132)',
        //                'rgb(170, 249, 33)',
        //                'rgb(6, 247, 188)',
        //                'rgb(4, 68, 252)',
        //                'rgb(250, 0, 171 )',
        //                'rgb(223, 105, 0 )',
        //                'rgb(1, 178, 255 )',
        //                'rgb(17, 229, 0 )',
        //                'rgb(181, 189, 87 )',
        //                'rgb(4, 138, 100 )'],
        //            borderWidth: 1,
        //            hoverOffset: 4
        //        }]
        //    },
        //    options: {
        //        responsive: true,
        //        scales: {
        //            y: {
        //                beginAtZero: true,

        //                max: 100000000
        //            }
        //        }
        //    }
        //});

        var ctx2 = document.getElementById("myChart2");
        new Chart(ctx2, {
            type: 'line',
            data: {
                labels: ['Giá trị nhỏ nhất', 'SUM', 'Giá trị lớn nhất'],
                datasets: [{
                    label: 'Tổng số tiền thu được',
                    data: ['100000', sum, '100000000'],
                    backgroundColor: 'rgba(0, 123, 255, 0.5)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    borderWidth: 1,
                    pointStyle: 'circle'
                }]
            },
            options: {
                scales: {
                    y: {
                        min: 0,
                        max: 100000000
                    }
                }
            }
        });


    },
    error: function (error) {
      
    }

   });
    
        /**CHART DONUT*/
        $.ajax({
            
            url: "@Url.Action("ChartData","Home")",
            type: "POST",
            dataType: "json",
            success: function (dataChart) {
                console.log(dataChart);
                var labelss = dataChart.map(function (item) {
                    return item.name;
                });

                var countss = dataChart.map(function (item) {
                    return item.count;
                });
                console.log(labelss);
                console.log(countss);
                // Cấu hình biểu đồ
                var ctx3 = document.getElementById("myChart3");
                var myChart = new Chart(ctx3, {
                    type: "doughnut",
                    data: {
                        labels: labelss,
                        datasets: [
                            {
                                label: "Tổng số bài",
                                data: countss,
                                backgroundColor: [
                                    "rgb(255, 87, 87",
                                    "rgb(255, 219, 15)",
                                    "rgb(87, 250, 0)",
                                    "rgb(0, 118, 250)",
                                    "rgb(166, 1, 255)",
                                    // Thêm các màu khác nếu cần
                                ],
                                borderColor: [
                                    "rgb(255, 87, 87",
                                    "rgb(255, 219, 15)",
                                    "rgb(87, 250, 0)",
                                    "rgb(0, 118, 250)",
                                    "rgb(166, 1, 255)",
                                    // Thêm các màu khác nếu cần
                                ],
                                borderWidth: 1,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        cutout: "70%", // Điều chỉnh kích thước lỗ giữa để tạo hình dạng donut
                        plugins: {
                            legend: {
                                position: "right"
                            }
                        }
                    }
                });

            },
            error: function (error) {
                // Xử lý lỗi (nếu có)
                console.log(error);
            },
        });
    

;

</script>


<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">

    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">ADMIN HOME</h1>
                </div><!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                     
                    </ol>
                </div><!-- /.col -->
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
      
            <!-- Small boxes (Stat box) -->
            <div class="row">
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-info">
                        <div class="inner">
                            <h4>Tổng số dự án</h4>

                            <p>@ViewBag.postCount</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-bag"></i>
                        </div>
                        
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                        <div class="inner">
                            <h4>Số dự án đang thực hiện<sup style="font-size: 20px"></sup></h4>

                            <p>@ViewBag.runningCount</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-warning">
                        <div class="inner">
                            <h4>Số dự án đã hoàn thành</h4>

                            <p>@ViewBag.completeCount</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-person-add"></i>
                        </div>
                        
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-danger">
                        <div class="inner">
                            <h4>Tổng tiền dự kiến</h4>

                            <p>@Convert.ToInt64(ViewBag.sumTarget).ToString("N0") VND</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-pie-graph"></i>
                        </div>
                        
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                        <div class="inner">
                            <h4>Tổng tiền đã thu</h4>

                            <p>@Convert.ToInt64(ViewBag.sumAmout).ToString("N0") VND</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                        <div class="inner">
                            <h3 style="width:fit-content;">Ngày tháng năm</h3>
                            <input type="date" name="name" value="" />
                          
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        
                    </div>
                </div>
                <!-- ./col -->
            </div>
            <!-- /.row -->
            <!-- Main row -->
            <div class="row">
                <!-- Left col -->
                <section class="col-lg-7 connectedSortable">
                    <!-- Custom tabs (Charts with tabs)-->
                    <div class="card card-primary">
                        <div class="card-header">
                            <h3 class="card-title">Area Chart</h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart">

                                <canvas id="myChart2" style="min-height: 250px; height: 300px; max-height: 300px; max-width: 100%;"></canvas>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->




                </section>
                <!-- /.Left col -->
                <!-- right col (We are only adding the ID to make the widgets sortable)-->
                <section class="col-lg-5 connectedSortable">
                    <!-- LINE CHART -->
                    <div class="card card-info">
                        <div class="card-header">
                            <h3 class="card-title">Line Chart</h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart">
                                <canvas id="myChart3" style="min-height: 250px; height: 300px; max-height: 300px; max-width: 100%;"></canvas>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                    <!-- /.card -->

                </section>
                <!-- right col -->
               
            </div>
            <!-- /.row (main row) -->
        </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->




</div>
<!-- /.content-wrapper -->
